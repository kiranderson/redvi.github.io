(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{203:function(e,v,s){"use strict";s.r(v);var t=s(3),a=Object(t.a)({},function(){var e=this,v=e.$createElement,s=e._self._c||v;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("p",[e._v("Для проведения резервного копирования файлов в linux есть множество способов и инструментов. Всё зависит от постановки задачи. В нашем распоряжении как консольные утилиты, так и графические. Как создание полного бэкапа, так и инкременального. Как сохранение резервной копии на внешний жёсткий диск, так и передача файлов на сервер. Многое из этого уже описывалось, что-то описываться не будет совсем за неименеем возможности проверить инструкцию на практике. Сегодня же захотелось ещё раз вспомнить о rsync, ранее уже вскользь упоминавшемся. Коротко, в виде шпаргалки для себя.")]),e._v(" "),s("p",[e._v("Для начала следует установить rsync. Применительно к дистрибутиву Gentoo Linux выглядит это так:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# emerge -av rsync")]),e._v("\nnet-misc/rsync-3.0.9-r2  "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("USE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"acl iconv -ipv6 -static -xattr"')]),e._v("\n")])])]),s("h2",{attrs:{id:"резервное-копирование-без-отмонтирования-раздеnов"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#резервное-копирование-без-отмонтирования-раздеnов","aria-hidden":"true"}},[e._v("#")]),e._v(" Резервное копирование без отмонтирования разделов")]),e._v(" "),s("p",[e._v("Создание полной резервной копии  пользовательского раздела:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("# mkdir /home/backup-root\n# rsync -PavHx /home/* /home/backup-root/\n")])])]),s("ul",[s("li",[e._v("Разбор аргументов (см. man rsync):")])]),e._v(" "),s("ul",[s("li",[e._v('-Pav --- "стандартный джентльменский набор": докачка оборванных файлов, сохранение прав доступа/времени;')]),e._v(" "),s("li",[e._v("-H --- поддержка жёстких ссылок;")]),e._v(" "),s("li",[e._v("-x --- не перескакивать через точки монтирования (если отдельно смонтированы /var, /usr, /boot, нужно будет их отдельно rsync'ать при создании бэкапа либо --exclude 'sys/"),s("em",[e._v("' --exclude 'proc/")]),e._v("' --exclude 'home/*')")])]),e._v(" "),s("p",[e._v("Некоторые опции rsync:")]),e._v(" "),s("ul",[s("li",[e._v("-v --verbose --- показать подробный вывод")]),e._v(" "),s("li",[e._v("-q --quiet --- не показывать сообщения об ошибках")]),e._v(" "),s("li",[e._v("-c --checksum --- выполнять проверку контрольных сумм")]),e._v(" "),s("li",[e._v('-a --archive --- "архивный" режим. Уже содержит флаги -rlptgoD, не копирует жёсткие ссылки')]),e._v(" "),s("li",[e._v("-r --recursive --- копируем рекурсивно")]),e._v(" "),s("li",[e._v("-b --backup --- указание на создание бэкапа")]),e._v(" "),s("li",[e._v("-l --links --- копирование симлинков")]),e._v(" "),s("li",[e._v("-z --compress --- сжатие файлов во время передач")]),e._v(" "),s("li",[e._v("--daemon --- запустить как rsync-демон")]),e._v(" "),s("li",[e._v("--stats --- выдавать статистику по передаче файлов")]),e._v(" "),s("li",[e._v("--progress --- показать % выполнения во время передачи")]),e._v(" "),s("li",[e._v("-p, --perms --- сохранять разрешения")]),e._v(" "),s("li",[e._v("-g, --group --- сохранять группу")]),e._v(" "),s("li",[e._v("-t, --times --- сохранять время")]),e._v(" "),s("li",[e._v("-o, --owner --- сохранять владельца (только root)")]),e._v(" "),s("li",[e._v("-D, --devices --- сохранять файлы устройств (только root)")]),e._v(" "),s("li",[e._v("-S, --sparse --- эффективно обработать фрагментированные файлы")]),e._v(" "),s("li",[e._v("--existing --- только обновить те файлы, которые уже существуют")]),e._v(" "),s("li",[e._v("--ignore-existing --- пропускать те файлы, которые уже существуют на приёмной стороне")]),e._v(" "),s("li",[e._v("--delete --- удалять файлы, которых нет на передающей стороне")]),e._v(" "),s("li",[e._v("--delete-excluded --- удалять файлы, которые исключены из списка копирования")]),e._v(" "),s("li",[e._v("--delete-after --- удалять после копирования, а не до него")]),e._v(" "),s("li",[e._v("-R, --relative --- использовать относительные пути")]),e._v(" "),s("li",[e._v("--partial --- сохранять частично переданные файлы")]),e._v(" "),s("li",[e._v("--progress --- показать процент  выполнения во время передачи")]),e._v(" "),s("li",[e._v("-P --- то же, что --partial --progress")]),e._v(" "),s("li",[e._v("-H, --hard-links --- сохранять жесткие ссылки")]),e._v(" "),s("li",[e._v("-x, --one-file-system --- не выходить за пределы файловой системы")])]),e._v(" "),s("p",[e._v("При последующем обновлении бэкапа:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("# rsync -PavHx --delete-after /home/* /home/backup-root/\n")])])]),s("p",[e._v("Этот способ отлично подходит для периодического создания копии "),s("code",[e._v("home")]),e._v("-каталога. Запустив всего одну команду, мы можем не терять время на перезагрузку и нам не нужен livecd. Но делать полный бэкап системы этим способом не рекомендуется, лучше воспользоваться утилитой cp.")])])},[],!1,null,null,null);v.default=a.exports}}]);