(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{232:function(t,s,a){"use strict";a.r(s);var n=a(3),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("В "),a("router-link",{attrs:{to:"/posts/get-absolute-url/"}},[t._v("предыдущем посте")]),t._v(" к рассмотрению был предложен\nвопрос о назначении собственных уникальных URL-адресов страницы и получения\nих полного пути. Сегодня тема та же, но другой фреймворк: для сравнения\nпосмотрим как того же самого результата можно добиться в Ruby On Rails.")],1),t._v(" "),a("p",[t._v("Собственно, почему вдруг Ruby? Нет, не будет утверждений будто он хуже или\nлучше Python'а, просто случайно попался на пути и весьма заинтриговал автора.\nЭтого достаточно, чтобы черкнуть о нём пару строк. Не исключено (если\nдружба наша с Ruby станет крепнуть), что время от времени здесь будут\nпоявляться небольшие заметки о Ruby или Ruby On Rails.")]),t._v(" "),a("p",[t._v("Подробных объяснений базовых вещей сегодня не предвидится. Если читателю\nранее не доводилось встречаться с Rails, есть\n"),a("a",{attrs:{href:"http://ruby.railstutorial.org/ruby-on-rails-tutorial-book",target:"_blank",rel:"noopener noreferrer"}},[t._v("добротное пошаговое руководство"),a("OutboundLink")],1),t._v(",\nдостаточное для быстрого старта и понимания приведённого ниже материала.")]),t._v(" "),a("p",[t._v("Зададим маршрут в "),a("code",[t._v("app/config/routes.rb")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language-ruby extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ruby"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# routes.rb:")]),t._v("\nget "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'articles/:slug'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'articles#show'")]),t._v("\n")])])]),a("p",[t._v("Это указание на то, что при обращении к странице будет вызван метод "),a("code",[t._v("show")]),t._v("\nиз контроллёра "),a("code",[t._v("articles_controller.rb")]),t._v(", отвечающего за вывод публикаций.")]),t._v(" "),a("p",[t._v("Перепроводим маршруты:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ rake routes\n")])])]),a("p",[t._v("Далее обратимся к указанному выше контроллёру. Он содержит различные методы,\nоперирующие нашей моделью. В примере ниже находит публикацию по определённым параметрам.")]),t._v(" "),a("div",{staticClass:"language-ruby extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ruby"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# articles_controller.rb")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token method-definition"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("show")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@article")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Article")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("find_by_slug"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token symbol"}},[t._v(":id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token method-definition"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("article_params")])]),t._v("\n    params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token symbol"}},[t._v(":article")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("permit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token symbol"}},[t._v(":title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token symbol"}},[t._v(":content")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token symbol"}},[t._v(":slug")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),a("p",[t._v("Собственно, модель. Здесь нас и поджидает самое интересное. Перед тем, как публикация будет записана в БД, создаётся поле "),a("code",[t._v("slug")]),t._v(". Для указания этого действия мы определяем "),a("code",[t._v("before_create")]),t._v(", в который передаём название функции — "),a("code",[t._v("create_slug")]),t._v(".")]),t._v(" "),a("p",[t._v("Можно каждый раз при создании статьи назначать её "),a("code",[t._v("slug")]),t._v(" вручную. Или же создавать это поле автоматически, исходя из названия статьи.")]),t._v(" "),a("p",[t._v("Если с английским языком всё более или менее понятно, то автоматический перевод с кириллицы на латиницу может совсем не радовать, поэтому в общем случае предлагается использовать первый вариант.")]),t._v(" "),a("div",{staticClass:"language-ruby extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ruby"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# article.rb")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Article")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ActiveRecord")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Base")]),t._v("\n  before_create "),a("span",{pre:!0,attrs:{class:"token symbol"}},[t._v(":create_slug")]),t._v("\n\n  default_scope order"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'articles.created_at DESC'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# сортировка статей")]),t._v("\n  validates "),a("span",{pre:!0,attrs:{class:"token symbol"}},[t._v(":slug")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" presence"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("maximum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# валидация")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token method-definition"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("to_param")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token delimiter tag"}},[t._v("#{")]),t._v("slug"),a("span",{pre:!0,attrs:{class:"token delimiter tag"}},[t._v("}")])]),t._v('/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("downcase "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# как выводить в URL")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token method-definition"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_slug")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# если в модели определено поле slug, slug задаётся вручную")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("self")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("slug"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("self")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("slug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parameterize\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# если поле slug не определено, генерируется автоматически")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# исходя из значения поля title (заголовок статьи)")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# self.slug=self.title.parameterize")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),a("p",[t._v("Наконец, пример вывода страницы публикации "),a("code",[t._v("show.html.erb")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language-erb extra-class"},[a("pre",{pre:!0,attrs:{class:"language-erb"}},[a("code",[a("span",{pre:!0,attrs:{class:"token erb language-erb"}},[a("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[t._v("<%")]),t._v(" provide"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token symbol"}},[t._v(":title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@article")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[t._v("%>")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token erb language-erb"}},[a("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[t._v("<%=")]),t._v(" link_to "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@article")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("title"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" article_path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@article")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[t._v("%>")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token erb language-erb"}},[a("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[t._v("<%=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@article")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("created_at"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("strftime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%d %B"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[t._v("%>")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token erb language-erb"}},[a("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[t._v("<%=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("@article")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("content "),a("span",{pre:!0,attrs:{class:"token delimiter punctuation"}},[t._v("%>")])]),t._v("\n")])])])])},[],!1,null,null,null);s.default=e.exports}}]);