<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Сделать emacs удобнее | Заметки на полях</title>
    <meta name="description" content="Собственные сниппеты. Как это делают в emacs?">
    <link rel="manifest" href="/manifest.json">
  <link rel="icon" href="/favicon.ico">
  <meta name="theme-color" content="#46bd87">
    
    <link rel="preload" href="/assets/css/0.styles.4993531b.css" as="style"><link rel="preload" href="/assets/js/app.6e4996bc.js" as="script"><link rel="preload" href="/assets/js/4.11d3a3db.js" as="script"><link rel="preload" href="/assets/js/50.d4cc05c9.js" as="script"><link rel="preload" href="/assets/js/28.785693ad.js" as="script"><link rel="prefetch" href="/assets/js/10.23d584b0.js"><link rel="prefetch" href="/assets/js/11.7e9fc27e.js"><link rel="prefetch" href="/assets/js/12.778cebda.js"><link rel="prefetch" href="/assets/js/13.f9a0865b.js"><link rel="prefetch" href="/assets/js/14.7e9142f5.js"><link rel="prefetch" href="/assets/js/15.81a256d2.js"><link rel="prefetch" href="/assets/js/16.49af5ffe.js"><link rel="prefetch" href="/assets/js/17.b44ee3ae.js"><link rel="prefetch" href="/assets/js/18.5aee35b6.js"><link rel="prefetch" href="/assets/js/19.0db9aae5.js"><link rel="prefetch" href="/assets/js/2.35b2c6bb.js"><link rel="prefetch" href="/assets/js/20.dd2ea1cb.js"><link rel="prefetch" href="/assets/js/21.393c5d86.js"><link rel="prefetch" href="/assets/js/22.56cf0890.js"><link rel="prefetch" href="/assets/js/23.155f85b8.js"><link rel="prefetch" href="/assets/js/24.b74b7cb5.js"><link rel="prefetch" href="/assets/js/25.eae2d23b.js"><link rel="prefetch" href="/assets/js/26.036b3a68.js"><link rel="prefetch" href="/assets/js/27.375f2bdb.js"><link rel="prefetch" href="/assets/js/29.11833701.js"><link rel="prefetch" href="/assets/js/3.a76664f0.js"><link rel="prefetch" href="/assets/js/30.6ecf91ca.js"><link rel="prefetch" href="/assets/js/31.5227900f.js"><link rel="prefetch" href="/assets/js/32.c60ace8f.js"><link rel="prefetch" href="/assets/js/33.b41a62d6.js"><link rel="prefetch" href="/assets/js/34.de1eca42.js"><link rel="prefetch" href="/assets/js/35.6640f8d9.js"><link rel="prefetch" href="/assets/js/36.5ae9284d.js"><link rel="prefetch" href="/assets/js/37.3bd95024.js"><link rel="prefetch" href="/assets/js/38.b492b55b.js"><link rel="prefetch" href="/assets/js/39.217589d9.js"><link rel="prefetch" href="/assets/js/40.f390632a.js"><link rel="prefetch" href="/assets/js/41.2a87ce19.js"><link rel="prefetch" href="/assets/js/42.0078f9a2.js"><link rel="prefetch" href="/assets/js/43.305a1d21.js"><link rel="prefetch" href="/assets/js/44.d68d09d3.js"><link rel="prefetch" href="/assets/js/45.725969ad.js"><link rel="prefetch" href="/assets/js/46.5006191f.js"><link rel="prefetch" href="/assets/js/47.02f0ac47.js"><link rel="prefetch" href="/assets/js/48.a1479944.js"><link rel="prefetch" href="/assets/js/49.f202290e.js"><link rel="prefetch" href="/assets/js/5.260a7e1b.js"><link rel="prefetch" href="/assets/js/51.351e60fc.js"><link rel="prefetch" href="/assets/js/52.2d05f9b0.js"><link rel="prefetch" href="/assets/js/53.bff13ad2.js"><link rel="prefetch" href="/assets/js/54.25ee54c4.js"><link rel="prefetch" href="/assets/js/55.9fe9e953.js"><link rel="prefetch" href="/assets/js/56.96ba4927.js"><link rel="prefetch" href="/assets/js/57.4e35a560.js"><link rel="prefetch" href="/assets/js/58.ae2210a1.js"><link rel="prefetch" href="/assets/js/59.8a325a55.js"><link rel="prefetch" href="/assets/js/6.58fecefc.js"><link rel="prefetch" href="/assets/js/60.16b2173a.js"><link rel="prefetch" href="/assets/js/61.9d2a0001.js"><link rel="prefetch" href="/assets/js/62.f563cd8e.js"><link rel="prefetch" href="/assets/js/63.1a72cc0f.js"><link rel="prefetch" href="/assets/js/64.e88ea223.js"><link rel="prefetch" href="/assets/js/65.13f19506.js"><link rel="prefetch" href="/assets/js/66.8c2e411f.js"><link rel="prefetch" href="/assets/js/67.f44e0d12.js"><link rel="prefetch" href="/assets/js/68.ea7ddfd9.js"><link rel="prefetch" href="/assets/js/69.b35d4c71.js"><link rel="prefetch" href="/assets/js/7.28b8ec71.js"><link rel="prefetch" href="/assets/js/70.11072557.js"><link rel="prefetch" href="/assets/js/71.17ae261d.js"><link rel="prefetch" href="/assets/js/8.42c742f4.js"><link rel="prefetch" href="/assets/js/9.3db5d928.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4993531b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="common common--light"><header class="header" data-v-32223a35><a href="/" aria-label="menu" class="hamburger" data-v-7ac966a8><div class="line-h" data-v-7ac966a8></div> <div class="text-wrap" data-v-7ac966a8></div> <svg width="42px" height="42px" viewBox="0 0 42 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" data-v-7ac966a8><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" data-v-7ac966a8><path id="square" stroke="#000000" width="41" height="41" d="M0.5 0.5 L41.5 0.5 L41.5 41.5 L0.5 41.5 Z" class="bz" data-v-7ac966a8></path></g></svg> <div class="line-h" data-v-7ac966a8></div></a></header> <main class="page content"><article><h1>Сниппеты в emacs</h1> <div class="content__default"><p>Сниппетом называют небольшой блок, фрагмент кода, предназначенный для повторного
использования. Современные текстовые редакторы зачастую содержат сниппеты для
разных задач и языков программирования.</p> <p>Например, в LaTeX это такие конструкции как</p> <div class="language-latex extra-class"><pre class="language-latex"><code><span class="token function selector">\begin</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span>
<span class="token function selector">\end</span><span class="token punctuation">{</span><span class="token keyword">document</span><span class="token punctuation">}</span>
</code></pre></div><p>С подобными кусочками кода в emacs тоже не бывает проблем. Однако, что если вам
не хочется при создании нового документа заполнять его
стандартным содержимым? Не весть как интересно наполнять стартовые файлы LaTeX
или HTML, не правда ли?</p> <p>Для такого случая можно заранее подготовить необходимые файлы-сниппеты, а при создании
нового документа просто вставлять их содержимое в буфер текстового редактора. И
здесь не обойтись без написания какой-нибудь полезной функции на emacs lisp.</p> <p>Рассмотрим несколько несложных примеров.</p> <h2 id="вставка-текста-прямо-из-функции"><a href="#вставка-текста-прямо-из-функции" aria-hidden="true" class="header-anchor">#</a> Вставка текста прямо из функции</h2> <p>В случае постоянного использования одного и того же языка программирования
заготовочные файлы иметь вовсе не обязательно: можно получить нужную
последовательность символов непосредственно из функции.</p> <p>Для этой нехитрой задачи воспользуемся командой вставки текста <code>insert</code>. В
двойных кавычках укажем нужный фрагмент кода.
Например:</p> <div class="language-lisp extra-class"><pre class="language-lisp"><code><span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">newpy</span> <span class="token punctuation">(</span><span class="token arguments"></span><span class="token punctuation">)</span></span> <span class="token comment">; определить функцию newpy</span>
  <span class="token string">&quot;Create new python document&quot;</span> <span class="token comment">; комментарий</span>
  <span class="token punctuation">(</span><span class="token interactive keyword">interactive</span><span class="token punctuation">)</span> <span class="token comment">; работать интерактивно</span>
  <span class="token comment">; вставить строки</span>
  <span class="token punctuation">(</span><span class="token car">insert</span> <span class="token string">&quot;#!/usr/bin/env python
 # -*<span class="token argument">-</span> coding: utf-8 -*-&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
</code></pre></div><p>Теперь при нажатии <code>M-x</code> (после рестарта emacs) можно смело вводить имя только
что созданной функции и наблюдать, как указанный текст будет вставлен в текущем
буфере на той строке, где стоит курсор.</p> <p>Если читатель относит себя к любителям горячих сочетаний клавиш, он может также
определить заветную комбинацию для быстрого вызова функции:</p> <div class="language-lisp extra-class"><pre class="language-lisp"><code><span class="token punctuation">(</span><span class="token car">global-set-key</span> <span class="token punctuation">(</span><span class="token car">kbd</span> <span class="token string">&quot;C-c s&quot;</span><span class="token punctuation">)</span> <span class="token quoted-symbol variable symbol">'newpy</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="поnучение-текста-из-файnа"><a href="#поnучение-текста-из-файnа" aria-hidden="true" class="header-anchor">#</a> Получение текста из файла</h2> <p>Обратимся к иному методу получения данных: вставке из определённого
файла.</p> <p>Создадим функцию <code>newtex</code>, которая будет забирать данные из указанного файла при
помощи <code>insert-file-contents</code>. При необходимости строки будут разделены.</p> <div class="language-lisp extra-class"><pre class="language-lisp"><code><span class="token punctuation">(</span><span class="token car">defun</span> newtex<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token string">&quot;Get data from the file ex.tex&quot;</span>
  <span class="token punctuation">(</span><span class="token interactive keyword">interactive</span><span class="token punctuation">)</span>
    <span class="token comment">; вставить данные из файла ex.tex</span>
    <span class="token punctuation">(</span><span class="token car">insert-file-contents</span> <span class="token string">&quot;~/ex.tex&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">; разделить строки</span>
    <span class="token punctuation">(</span><span class="token car">split-string</span> <span class="token punctuation">(</span><span class="token car">buffer-string</span><span class="token punctuation">)</span> <span class="token string">&quot;\n&quot;</span> <span class="token boolean">t</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>Разделять строки совершенно необязательно: ведь заранее заготовленный сниппет уже
приведён к соответствующему виду. Определить комбинацию клавиш можно так же, как
это уже было показано ранее.</p> <p>Теперь предлагается немного усовершенствовать функцию, дабы иметь возможность вставлять
содержимое из разных файлов в зависимости от переданного функции аргумента.</p> <p>В следующем примере даётся функция <code>snip</code>, которая принимает аргумент
<code>ext</code>. Она взаимодействует с пользователем, получает от него имя расширения
файла (аргумент) и открывает соответствующий ему файл. Для выбора файла
используется конструкция <code>if</code>.</p> <div class="language-lisp extra-class"><pre class="language-lisp"><code><span class="token punctuation">(</span><span class="token defun"><span class="token keyword">defun</span> <span class="token function">snip</span> <span class="token punctuation">(</span><span class="token arguments"><span class="token argument variable">ext</span></span><span class="token punctuation">)</span></span> <span class="token comment">; ожидает аргумента ext</span>
  <span class="token string">&quot;Get data from the file.&quot;</span>
  <span class="token punctuation">(</span><span class="token interactive keyword">interactive</span> <span class="token string">&quot;sExtension: &quot;</span><span class="token punctuation">)</span> <span class="token comment">; приглашение для ввода строки</span>
  <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token car">equal</span> ext <span class="token string">&quot;html&quot;</span><span class="token punctuation">)</span> <span class="token comment">; проверить на равенство</span>
      <span class="token punctuation">(</span><span class="token car">insert-file-contents</span> <span class="token string">&quot;~/ex.tex&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token car">equal</span> ext <span class="token string">&quot;py&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">(</span><span class="token car">insert-file-contents</span> <span class="token string">&quot;~/ex.py&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
  <span class="token comment">; если аргумента нет</span>
  <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token boolean">nil</span> <span class="token punctuation">(</span><span class="token keyword">message</span> <span class="token string">&quot;argument is nil&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
</code></pre></div><p>Так, в несколько строчек кода вместилась весьма полезная функция, способная
сделать работу с emacs ещё чуточку продуктивнее. Можно ли использовать для сегодняшней
цели сторонние «фичи» emacs автору неведомо. Но нужны ли они, если и
так всё просто?</p></div> <div class="tags" data-v-1c67afbc><span data-v-1c67afbc>2014</span> 

  <a href="/?tag=editors" data-v-1c67afbc>
    editors
  </a></div> <div class="prev-next" data-v-326f747b><div class="prev-next__prev" data-v-326f747b><a href="/posts/linux-command/" data-v-326f747b>
      Основные команды linux
    </a></div> <div class="prev-next__between" data-v-326f747b>⤧</div> <div class="prev-next__next" data-v-326f747b><a href="/posts/whois/" data-v-326f747b>
      Whois-Client
    </a></div></div> <!----></article></main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.6e4996bc.js" defer></script><script src="/assets/js/4.11d3a3db.js" defer></script><script src="/assets/js/50.d4cc05c9.js" defer></script><script src="/assets/js/28.785693ad.js" defer></script>
  </body>
</html>
